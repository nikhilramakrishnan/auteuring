---
interface Props {
  src: string;
  title?: string;
  aspectRatio?: '16:9' | '4:3' | '1:1';
  allowFullscreen?: boolean;
  blockCorner?: boolean;
}

const {
  src,
  title = 'Embedded content',
  aspectRatio = '16:9',
  allowFullscreen = true,
  blockCorner = false
} = Astro.props;

const paddingMap = {
  '16:9': '56.25%',
  '4:3': '75%',
  '1:1': '100%'
};
---

<div class="responsive-embed" style={`padding-bottom: ${paddingMap[aspectRatio]}`}>
  <iframe
    src={src}
    title={title}
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
    allowfullscreen={allowFullscreen}
    loading="lazy"
  />
  {blockCorner && <div class="corner-blocker" />}
</div>

<style>
  .responsive-embed {
    position: relative;
    width: 100%;
    height: 0;
    margin: 1.5em 0;
    border-radius: 8px;
    overflow: hidden;
  }

  .responsive-embed iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }

  .corner-blocker {
    position: absolute;
    top: 0;
    right: 0;
    width: 60px;
    height: 60px;
    z-index: 10;
    cursor: default;
  }
</style>
